---
import { Icon } from 'astro-icon/components';
---

<section class="py-16 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="jyotirsetu-newsletter">
      <!-- Newsletter Header -->
      <div class="text-center mb-8">
        <div class="w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <Icon name="tabler:mail" class="h-8 w-8 text-white" />
        </div>
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
          Stay Connected with Cosmic Insights
        </h2>
        <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
          Get weekly horoscopes, astrology tips, and spiritual guidance delivered directly to your inbox. 
          Join thousands of readers who trust JyotirSetu for their cosmic journey.
        </p>
      </div>
      
      <!-- Newsletter Benefits -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="text-center">
          <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-3">
            <Icon name="tabler:calendar" class="h-6 w-6 text-blue-600 dark:text-blue-400" />
          </div>
          <h3 class="font-semibold text-gray-900 dark:text-white mb-2">Weekly Horoscopes</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">
            Personalized forecasts for all zodiac signs
          </p>
        </div>
        
        <div class="text-center">
          <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mx-auto mb-3">
            <Icon name="tabler:book" class="h-6 w-6 text-purple-600 dark:text-purple-400" />
          </div>
          <h3 class="font-semibold text-gray-900 dark:text-white mb-2">Exclusive Content</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">
            In-depth astrology guides and spiritual wisdom
          </p>
        </div>
        
        <div class="text-center">
          <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-3">
            <Icon name="tabler:gift" class="h-6 w-6 text-green-600 dark:text-green-400" />
          </div>
          <h3 class="font-semibold text-gray-900 dark:text-white mb-2">Special Offers</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">
            Discounts on consultations and exclusive access
          </p>
        </div>
      </div>
      
      <!-- Newsletter Form -->
      <form class="max-w-md mx-auto" id="newsletter-form">
        <div class="flex flex-col sm:flex-row gap-3">
          <input
            type="email"
            name="email"
            placeholder="Enter your email address"
            class="flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
            required
          />
          <button
            type="submit"
            class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-sm font-semibold rounded-full hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1"
          >
            <span class="newsletter-btn-text">Subscribe</span>
            <span class="newsletter-btn-loading hidden">
              <div class="jyotirsetu-loading"></div>
            </span>
          </button>
        </div>
        
        <!-- Privacy Notice -->
        <p class="text-xs text-gray-500 dark:text-gray-400 text-center mt-3">
          We respect your privacy. Unsubscribe at any time. 
          <a href="/privacy" class="text-blue-600 dark:text-blue-400 hover:underline">Privacy Policy</a>
        </p>
      </form>
      
      <!-- Social Proof -->
      <div class="text-center mt-8">
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
          Join <span class="font-semibold text-blue-600 dark:text-blue-400">2,500+</span> cosmic seekers
        </p>
        <div class="flex justify-center space-x-4">
          <div class="flex -space-x-2">
            <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center">
              <span class="text-xs font-semibold text-white">A</span>
            </div>
            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center">
              <span class="text-xs font-semibold text-white">B</span>
            </div>
            <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-green-600 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center">
              <span class="text-xs font-semibold text-white">C</span>
            </div>
            <div class="w-8 h-8 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center">
              <span class="text-xs font-semibold text-white">D</span>
            </div>
            <div class="w-8 h-8 bg-gradient-to-r from-pink-500 to-pink-600 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center">
              <span class="text-xs font-semibold text-white">E</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Newsletter Form Script -->
<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('newsletter-form');
    const submitBtn = form.querySelector('button[type="submit"]');
    const btnText = submitBtn.querySelector('.newsletter-btn-text');
    const btnLoading = submitBtn.querySelector('.newsletter-btn-loading');
    
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = form.querySelector('input[name="email"]').value;
      
      // Show loading state
      btnText.classList.add('hidden');
      btnLoading.classList.remove('hidden');
      submitBtn.disabled = true;
      
      try {
        // Simulate API call (replace with actual newsletter signup endpoint)
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Success state
        btnText.textContent = 'Subscribed!';
        btnText.classList.remove('hidden');
        btnLoading.classList.add('hidden');
        submitBtn.classList.remove('from-blue-600', 'to-purple-600', 'hover:from-blue-700', 'hover:to-purple-700');
        submitBtn.classList.add('from-green-600', 'to-green-600');
        
        // Track newsletter signup
        if (window.JyotirsetuBlog) {
          window.JyotirsetuBlog.trackBlogInteraction('newsletter_signup', 'blog');
        }
        
        // Reset form
        form.reset();
        
        // Reset button after 3 seconds
        setTimeout(() => {
          btnText.textContent = 'Subscribe';
          submitBtn.classList.remove('from-green-600', 'to-green-600');
          submitBtn.classList.add('from-blue-600', 'to-purple-600', 'hover:from-blue-700', 'hover:to-purple-700');
          submitBtn.disabled = false;
        }, 3000);
        
      } catch (error) {
        // Error state
        btnText.textContent = 'Try Again';
        btnText.classList.remove('hidden');
        btnLoading.classList.add('hidden');
        submitBtn.disabled = false;
        
        console.error('Newsletter signup error:', error);
      }
    });
  });
</script>
